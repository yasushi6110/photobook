
COLUMN_YHK = 0.005
ROW_YHK = 0.005
IMAGE_EXTS = ('.png', '.jpg', '.jpeg', '.bmp', '.gif', '.tiff')


def tile_base(column, row, total_columns, total_rows, column_scale=1, row_scale=None,
              column_yhk=COLUMN_YHK, row_yhk=ROW_YHK):
    base_row_size = 1 - row_yhk * 2.0
    base_column_size = 1 - column_yhk * 2.0
    column_size = base_row_size/float(total_columns)
    row_size = base_column_size/float(total_rows)
    if not row_scale:
        row_scale = column_scale
    return (COLUMN_YHK+column*column_size, ROW_YHK+row*row_size, column_size*column_scale, row_size*row_scale)


def tiled87(column, row, column_scale=1, row_scale=None):
    return tile_base(column, row, 8, 7, column_scale, row_scale)


def tiled46(column, row, column_scale=1, row_scale=None):
    return tile_base(column, row, 4, 6, column_scale, row_scale)


def size_checker(column=141, row=100):
    result = []
    for cl in range(column):
        for rw in range(row):
            result.append(tile_base(cl, rw, column, row, 1, 1, 0, 0))
    return result


SIZE_PRESETS = {
    "A4 842 x 595 px (72 DPI)": (842, 595),
    "A4 1123 x 794 px (96 DPI)": (1123, 794),
    "A4 1754 x 1240 px (150 DPI)": (1754, 1240),
    "A4 3508 x 2480 px (300 DPI)": (3508, 2480),
    "A4 4093 x 2894 px (350 DPI)": (4093, 2894),
    "A4 4677 x 3307 px (400 DPI)": (4677, 3307),
}

LAYOUT_PRESETS = {
    "横 family": [
        tiled87(0, 0), tiled87(1, 0), tiled87(2, 0), tiled87(3, 0), tiled87(4, 0), tiled87(5, 0), tiled87(6, 0), tiled87(7, 0),
        tiled87(0, 1), tiled87(1, 1, 2),             tiled87(3, 1), tiled87(4, 1), tiled87(5, 1), tiled87(6, 1), tiled87(7, 1),
        tiled87(0, 2),                               tiled87(3, 2), tiled87(4, 2), tiled87(5, 2), tiled87(6, 2), tiled87(7, 2),
        tiled87(0, 3), tiled87(1, 3), tiled87(2, 3), tiled87(3, 3, 2, 1),          tiled87(5, 3), tiled87(6, 3), tiled87(7, 3),
        tiled87(0, 4), tiled87(1, 4), tiled87(2, 4), tiled87(3, 4), tiled87(4, 4), tiled87(5, 4, 2),             tiled87(7, 4),
        tiled87(0, 5), tiled87(1, 5), tiled87(2, 5), tiled87(3, 5), tiled87(4, 5),                               tiled87(7, 5),
        tiled87(0, 6), tiled87(1, 6), tiled87(2, 6), tiled87(3, 6), tiled87(4, 6), tiled87(5, 6), tiled87(6, 6), tiled87(7, 6),
    ],
    "横 default": [
        tiled87(0, 0), tiled87(1, 0), tiled87(2, 0), tiled87(3, 0), tiled87(4, 0), tiled87(5, 0), tiled87(6, 0), tiled87(7, 0),
        tiled87(0, 1), tiled87(1, 1), tiled87(2, 1), tiled87(3, 1), tiled87(4, 1), tiled87(5, 1), tiled87(6, 1), tiled87(7, 1),
        tiled87(0, 2), tiled87(1, 2), tiled87(2, 2), tiled87(3, 2), tiled87(4, 2), tiled87(5, 2), tiled87(6, 2), tiled87(7, 2),
        tiled87(0, 3), tiled87(1, 3), tiled87(2, 3), tiled87(3, 3), tiled87(4, 3), tiled87(5, 3), tiled87(6, 3), tiled87(7, 3),
        tiled87(0, 4), tiled87(1, 4), tiled87(2, 4), tiled87(3, 4), tiled87(4, 4), tiled87(5, 4), tiled87(6, 4), tiled87(7, 4),
        tiled87(0, 5), tiled87(1, 5), tiled87(2, 5), tiled87(3, 5), tiled87(4, 5), tiled87(5, 5), tiled87(6, 5), tiled87(7, 5),
        tiled87(0, 6), tiled87(1, 6), tiled87(2, 6), tiled87(3, 6), tiled87(4, 6), tiled87(5, 6), tiled87(6, 6), tiled87(7, 6),
    ],
    "横 layout01" : [(0.0, 0.0, 0.2221, 0.4454), (0.2221, 0.0, 0.2221, 0.4454), (0.0, 0.4454, 0.2221, 0.2218), (0.2221, 0.4454, 0.2221, 0.2218), (0.0, 0.6672, 0.1485, 0.3328), (0.1485, 0.6672, 0.1473, 0.3328), (0.2957, 0.6672, 0.1485, 0.3328), (0.4442, 0.0, 0.1116, 0.2504), (0.4442, 0.2504, 0.1116, 0.2504), (0.4442, 0.5008, 0.1116, 0.2487), (0.4442, 0.7496, 0.1116, 0.2504), (0.5558, 0.0, 0.1485, 0.3328), (0.7043, 0.0, 0.1473, 0.3328), (0.8515, 0.0, 0.1485, 0.3328), (0.5558, 0.3328, 0.2221, 0.3345), (0.7779, 0.3328, 0.2221, 0.3345), (0.5558, 0.6672, 0.2221, 0.3328), (0.7779, 0.6672, 0.2221, 0.3328)],
    '横 layout02': [(0.00,0.00,0.20,0.25),(0.20,0.00,0.20,0.25),(0.00,0.25,0.25,0.25),(0.25,0.25,0.15,0.25),(0.00,0.50,0.20,0.25),(0.20,0.50,0.20,0.25),(0.00,0.75,0.25,0.25),(0.25,0.75,0.15,0.25),(0.40,0.00,0.20,0.20),(0.40,0.20,0.20,0.20),(0.40,0.40,0.20,0.20),(0.40,0.60,0.20,0.20),(0.40,0.80,0.20,0.20),(0.60,0.00,0.20,0.25),(0.80,0.00,0.20,0.25),(0.60,0.25,0.20,0.25),(0.80,0.25,0.20,0.25),(0.60,0.50,0.20,0.25),(0.80,0.50,0.20,0.25),(0.60,0.75,0.20,0.25),(0.80,0.75,0.20,0.25)],
    '横 layout03': [(0.00,0.00,0.125,0.15),(0.125,0.00,0.125,0.15),(0.25,0.00,0.125,0.15),(0.375,0.00,0.125,0.15),(0.50,0.00,0.125,0.15),(0.625,0.00,0.125,0.15),(0.75,0.00,0.125,0.15),(0.875,0.00,0.125,0.15),(0.00,0.15,0.15,0.20),(0.15,0.15,0.15,0.20),(0.30,0.15,0.40,0.20),(0.70,0.15,0.15,0.20),(0.85,0.15,0.15,0.20),(0.00,0.35,0.15,0.30),(0.15,0.35,0.15,0.30),(0.30,0.35,0.40,0.30),(0.70,0.35,0.15,0.30),(0.85,0.35,0.15,0.30),(0.00,0.65,0.15,0.20),(0.15,0.65,0.15,0.20),(0.30,0.65,0.40,0.20),(0.70,0.65,0.15,0.20),(0.85,0.65,0.15,0.20),(0.00,0.85,0.125,0.15),(0.125,0.85,0.125,0.15),(0.25,0.85,0.125,0.15),(0.375,0.85,0.125,0.15),(0.50,0.85,0.125,0.15),(0.625,0.85,0.125,0.15),(0.75,0.85,0.125,0.15),(0.875,0.85,0.125,0.15)],
    '横 layout04': [(0.00,0.00,0.20,0.12),(0.20,0.00,0.20,0.12),(0.40,0.00,0.20,0.12),(0.60,0.00,0.20,0.12),(0.80,0.00,0.20,0.12),(0.00,0.12,0.30,0.18),(0.30,0.12,0.20,0.18),(0.50,0.12,0.25,0.18),(0.75,0.12,0.25,0.18),(0.00,0.30,0.50,0.30),(0.50,0.30,0.50,0.30),(0.00,0.60,0.30,0.20),(0.30,0.60,0.20,0.20),(0.50,0.60,0.25,0.20),(0.75,0.60,0.25,0.20),(0.00,0.80,0.20,0.20),(0.20,0.80,0.20,0.20),(0.40,0.80,0.20,0.20),(0.60,0.80,0.20,0.20),(0.80,0.80,0.20,0.20)],
    '横 layout05': [(0.00,0.00,0.25,0.20),(0.25,0.00,0.25,0.20),(0.50,0.00,0.25,0.20),(0.75,0.00,0.25,0.20),(0.00,0.20,0.30,0.25),(0.30,0.20,0.20,0.25),(0.50,0.20,0.20,0.25),(0.70,0.20,0.30,0.25),(0.00,0.45,0.20,0.25),(0.20,0.45,0.20,0.25),(0.40,0.45,0.20,0.25),(0.60,0.45,0.20,0.25),(0.80,0.45,0.20,0.25),(0.00,0.70,0.33,0.30),(0.33,0.70,0.34,0.30),(0.67,0.70,0.33,0.30)],
    "縦 tiled4x6_default": size_checker(4, 6),
    "縦 tiled4x6_layout1": [
        tiled46(0, 0),   tiled46(1, 0), tiled46(2, 0, 2),
        tiled46(0, 1),   tiled46(1, 1),
        tiled46(0, 2, 2),             tiled46(2, 2), tiled46(3, 2),
                                      tiled46(2, 3), tiled46(3, 3),
        tiled46(0, 4),   tiled46(1, 4), tiled46(2, 4, 2),
        tiled46(0, 5),   tiled46(1, 5),
    ],
    "size_checker": size_checker(),
}
SIZE_SWITCH_LAYOUT = ['縦 tiled4x6_default', '縦 tiled4x6_layout1', '縦 grid2x2', '縦 layout3']

