
COLUMN_YHK = 0.000
ROW_YHK = 0.000
IMAGE_EXTS = ('.png', '.jpg', '.jpeg', '.bmp', '.gif', '.tiff', '.heic')


def tile_base(column, row, total_columns, total_rows, column_scale=1, row_scale=None,
              column_yhk=COLUMN_YHK, row_yhk=ROW_YHK):
    base_row_size = 1 - row_yhk * 2.0
    base_column_size = 1 - column_yhk * 2.0
    column_size = base_row_size/float(total_columns)
    row_size = base_column_size/float(total_rows)
    if not row_scale:
        row_scale = column_scale
    return (COLUMN_YHK+column*column_size, ROW_YHK+row*row_size, column_size*column_scale, row_size*row_scale)


def tiled87(column, row, column_scale=1, row_scale=None):
    return tile_base(column, row, 8, 7, column_scale, row_scale)


def tiled46(column, row, column_scale=1, row_scale=None):
    return tile_base(column, row, 4, 6, column_scale, row_scale)


def tile_layout(column=141, row=100):
    result = []
    for rw in range(row):
        for cl in range(column):
            result.append(tile_base(cl, rw, column, row, 1, 1, 0, 0))
    return result


SIZE_PRESETS = {
    # === A3 ===
    'A3 4677 x 6614 px (400 DPI)': (4677, 6614, 400),
    'A3 4093 x 5787 px (350 DPI)': (4093, 5787, 350),
    'A3 3508 x 4961 px (300 DPI)': (3508, 4961, 300),
    'A3 2913 x 4134 px (250 DPI)': (2913, 4134, 250),

    # === A4 ===
    'A4 3307 x 4677 px (400 DPI)': (3307, 4677, 400),
    'A4 2894 x 4093 px (350 DPI)': (2894, 4093, 350),
    'A4 2480 x 3508 px (300 DPI)': (2480, 3508, 300),
    'A4 2067 x 2923 px (250 DPI)': (2067, 2923, 250),

    # === 四切 ===
    '四切 4000 x 4820 px (400 DPI)': (4000, 4820, 400),
    '四切 3500 x 4218 px (350 DPI)': (3500, 4218, 350),
    '四切 3000 x 3615 px (300 DPI)': (3000, 3615, 300),
    '四切 2500 x 3013 px (250 DPI)': (2500, 3013, 250),

    # === ワイド四切 ===
    'ワイド四切 4000 x 5772 px (400 DPI)': (4000, 5772, 400),
    'ワイド四切 3500 x 5050 px (350 DPI)': (3500, 5050, 350),
    'ワイド四切 3000 x 4329 px (300 DPI)': (3000, 4329, 300),
    'ワイド四切 2500 x 3608 px (250 DPI)': (2500, 3608, 250),

    # === 六切 ===
    '六切 3206 x 4024 px (400 DPI)': (3206, 4024, 400),
    '六切 2805 x 3521 px (350 DPI)': (2805, 3521, 350),
    '六切 2404 x 3018 px (300 DPI)': (2404, 3018, 300),
    '六切 2003 x 2515 px (250 DPI)': (2003, 2515, 250),

    # === ワイド六切 ===
    'ワイド六切 3206 x 4820 px (400 DPI)': (3206, 4820, 400),
    'ワイド六切 2805 x 4218 px (350 DPI)': (2805, 4218, 350),
    'ワイド六切 2404 x 3615 px (300 DPI)': (2404, 3615, 300),
    'ワイド六切 2003 x 3013 px (250 DPI)': (2003, 3013, 250),

    # === 2L ===
    '2L 2000 x 2803 px (400 DPI)': (2000, 2803, 400),
    '2L 1750 x 2453 px (350 DPI)': (1750, 2453, 350),
    '2L 1500 x 2103 px (300 DPI)': (1500, 2103, 300),
    '2L 1250 x 1752 px (250 DPI)': (1250, 1752, 250),

    # === KG判 ===
    'KG 1608 x 2392 px (400 DPI)': (1608, 2392, 400),
    'KG 1407 x 2093 px (350 DPI)': (1407, 2093, 350),
    'KG 1206 x 1795 px (300 DPI)': (1206, 1795, 300),
    'KG 1005 x 1496 px (250 DPI)': (1005, 1496, 250),

    # === ハガキ ===
    'ハガキ 1559 x 2339 px (400 DPI)': (1559, 2339, 400),
    'ハガキ 1364 x 2044 px (350 DPI)': (1364, 2044, 350),
    'ハガキ 1169 x 1750 px (300 DPI)': (1169, 1750, 300),
    'ハガキ 974 x 1456 px (250 DPI)': (974, 1456, 250),

    # === L判 ===
    'L判 1402 x 2000 px (400 DPI)': (1402, 2000, 400),
    'L判 1227 x 1750 px (350 DPI)': (1227, 1750, 350),
    'L判 1052 x 1500 px (300 DPI)': (1052, 1500, 300),
    'L判 877 x 1250 px (250 DPI)': (877, 1250, 250),

    # === iPhone 12 / 13 / 14 系列 ===
    'iPhone 14, 15, 16 (8064 x 6048)': (6048, 8064, None),
    'iPhone 12, 13 (4032 x 3024)': (3024, 4032, None),
}


LAYOUT_PRESETS = {
    "横 family": [
        tiled87(0, 0), tiled87(1, 0), tiled87(2, 0), tiled87(3, 0), tiled87(4, 0), tiled87(5, 0), tiled87(6, 0), tiled87(7, 0),
        tiled87(0, 1), tiled87(1, 1, 2),             tiled87(3, 1), tiled87(4, 1), tiled87(5, 1), tiled87(6, 1), tiled87(7, 1),
        tiled87(0, 2),                               tiled87(3, 2), tiled87(4, 2), tiled87(5, 2), tiled87(6, 2), tiled87(7, 2),
        tiled87(0, 3), tiled87(1, 3), tiled87(2, 3), tiled87(3, 3, 2, 1),          tiled87(5, 3), tiled87(6, 3), tiled87(7, 3),
        tiled87(0, 4), tiled87(1, 4), tiled87(2, 4), tiled87(3, 4), tiled87(4, 4), tiled87(5, 4, 2),             tiled87(7, 4),
        tiled87(0, 5), tiled87(1, 5), tiled87(2, 5), tiled87(3, 5), tiled87(4, 5),                               tiled87(7, 5),
        tiled87(0, 6), tiled87(1, 6), tiled87(2, 6), tiled87(3, 6), tiled87(4, 6), tiled87(5, 6), tiled87(6, 6), tiled87(7, 6),
    ],
    "横 default": [
        tiled87(0, 0), tiled87(1, 0), tiled87(2, 0), tiled87(3, 0), tiled87(4, 0), tiled87(5, 0), tiled87(6, 0), tiled87(7, 0),
        tiled87(0, 1), tiled87(1, 1), tiled87(2, 1), tiled87(3, 1), tiled87(4, 1), tiled87(5, 1), tiled87(6, 1), tiled87(7, 1),
        tiled87(0, 2), tiled87(1, 2), tiled87(2, 2), tiled87(3, 2), tiled87(4, 2), tiled87(5, 2), tiled87(6, 2), tiled87(7, 2),
        tiled87(0, 3), tiled87(1, 3), tiled87(2, 3), tiled87(3, 3), tiled87(4, 3), tiled87(5, 3), tiled87(6, 3), tiled87(7, 3),
        tiled87(0, 4), tiled87(1, 4), tiled87(2, 4), tiled87(3, 4), tiled87(4, 4), tiled87(5, 4), tiled87(6, 4), tiled87(7, 4),
        tiled87(0, 5), tiled87(1, 5), tiled87(2, 5), tiled87(3, 5), tiled87(4, 5), tiled87(5, 5), tiled87(6, 5), tiled87(7, 5),
        tiled87(0, 6), tiled87(1, 6), tiled87(2, 6), tiled87(3, 6), tiled87(4, 6), tiled87(5, 6), tiled87(6, 6), tiled87(7, 6),
    ],
    "横 layout01" : [(0.0, 0.0, 0.2221, 0.4454), (0.2221, 0.0, 0.2221, 0.4454), (0.0, 0.4454, 0.2221, 0.2218), (0.2221, 0.4454, 0.2221, 0.2218), (0.0, 0.6672, 0.1485, 0.3328), (0.1485, 0.6672, 0.1473, 0.3328), (0.2957, 0.6672, 0.1485, 0.3328), (0.4442, 0.0, 0.1116, 0.2504), (0.4442, 0.2504, 0.1116, 0.2504), (0.4442, 0.5008, 0.1116, 0.2487), (0.4442, 0.7496, 0.1116, 0.2504), (0.5558, 0.0, 0.1485, 0.3328), (0.7043, 0.0, 0.1473, 0.3328), (0.8515, 0.0, 0.1485, 0.3328), (0.5558, 0.3328, 0.2221, 0.3345), (0.7779, 0.3328, 0.2221, 0.3345), (0.5558, 0.6672, 0.2221, 0.3328), (0.7779, 0.6672, 0.2221, 0.3328)],
    '横 layout02': [(0.00,0.00,0.20,0.25),(0.20,0.00,0.20,0.25),(0.00,0.25,0.25,0.25),(0.25,0.25,0.15,0.25),(0.00,0.50,0.20,0.25),(0.20,0.50,0.20,0.25),(0.00,0.75,0.25,0.25),(0.25,0.75,0.15,0.25),(0.40,0.00,0.20,0.20),(0.40,0.20,0.20,0.20),(0.40,0.40,0.20,0.20),(0.40,0.60,0.20,0.20),(0.40,0.80,0.20,0.20),(0.60,0.00,0.20,0.25),(0.80,0.00,0.20,0.25),(0.60,0.25,0.20,0.25),(0.80,0.25,0.20,0.25),(0.60,0.50,0.20,0.25),(0.80,0.50,0.20,0.25),(0.60,0.75,0.20,0.25),(0.80,0.75,0.20,0.25)],
    '横 layout03': [(0.00,0.00,0.125,0.15),(0.125,0.00,0.125,0.15),(0.25,0.00,0.125,0.15),(0.375,0.00,0.125,0.15),(0.50,0.00,0.125,0.15),(0.625,0.00,0.125,0.15),(0.75,0.00,0.125,0.15),(0.875,0.00,0.125,0.15),(0.00,0.15,0.15,0.20),(0.15,0.15,0.15,0.20),(0.30,0.15,0.40,0.20),(0.70,0.15,0.15,0.20),(0.85,0.15,0.15,0.20),(0.00,0.35,0.15,0.30),(0.15,0.35,0.15,0.30),(0.30,0.35,0.40,0.30),(0.70,0.35,0.15,0.30),(0.85,0.35,0.15,0.30),(0.00,0.65,0.15,0.20),(0.15,0.65,0.15,0.20),(0.30,0.65,0.40,0.20),(0.70,0.65,0.15,0.20),(0.85,0.65,0.15,0.20),(0.00,0.85,0.125,0.15),(0.125,0.85,0.125,0.15),(0.25,0.85,0.125,0.15),(0.375,0.85,0.125,0.15),(0.50,0.85,0.125,0.15),(0.625,0.85,0.125,0.15),(0.75,0.85,0.125,0.15),(0.875,0.85,0.125,0.15)],
    '横 layout04': [(0.00,0.00,0.20,0.12),(0.20,0.00,0.20,0.12),(0.40,0.00,0.20,0.12),(0.60,0.00,0.20,0.12),(0.80,0.00,0.20,0.12),(0.00,0.12,0.30,0.18),(0.30,0.12,0.20,0.18),(0.50,0.12,0.25,0.18),(0.75,0.12,0.25,0.18),(0.00,0.30,0.50,0.30),(0.50,0.30,0.50,0.30),(0.00,0.60,0.30,0.20),(0.30,0.60,0.20,0.20),(0.50,0.60,0.25,0.20),(0.75,0.60,0.25,0.20),(0.00,0.80,0.20,0.20),(0.20,0.80,0.20,0.20),(0.40,0.80,0.20,0.20),(0.60,0.80,0.20,0.20),(0.80,0.80,0.20,0.20)],
    '横 layout05': [(0.00,0.00,0.25,0.20),(0.25,0.00,0.25,0.20),(0.50,0.00,0.25,0.20),(0.75,0.00,0.25,0.20),(0.00,0.20,0.30,0.25),(0.30,0.20,0.20,0.25),(0.50,0.20,0.20,0.25),(0.70,0.20,0.30,0.25),(0.00,0.45,0.20,0.25),(0.20,0.45,0.20,0.25),(0.40,0.45,0.20,0.25),(0.60,0.45,0.20,0.25),(0.80,0.45,0.20,0.25),(0.00,0.70,0.33,0.30),(0.33,0.70,0.34,0.30),(0.67,0.70,0.33,0.30)],
    "横 layout06" : [(0.0, 0.0, 0.2126, 0.4639), (0.2126, 0.0, 0.2126, 0.2857), (0.2126, 0.2857, 0.2126, 0.1782), (0.0, 0.4639, 0.1461, 0.2504), (0.1461, 0.4639, 0.2791, 0.2504), (0.0, 0.7143, 0.1413, 0.2857), (0.1413, 0.7143, 0.1425, 0.2857), (0.2838, 0.7143, 0.1413, 0.2857), (0.4252, 0.0, 0.1496, 0.2504), (0.4252, 0.2504, 0.1496, 0.2504), (0.4252, 0.5008, 0.1496, 0.2487), (0.4252, 0.7496, 0.1496, 0.2504), (0.5748, 0.0, 0.1413, 0.2857), (0.7162, 0.0, 0.1425, 0.2857), (0.8587, 0.0, 0.1413, 0.2857), (0.5748, 0.2857, 0.2126, 0.2504), (0.7874, 0.2857, 0.2126, 0.2504), (0.5748, 0.5361, 0.2126, 0.1782), (0.5748, 0.7143, 0.2126, 0.2857), (0.7874, 0.5361, 0.2126, 0.4639)],
    "横 layout07" : [(0.0, 0.0, 0.1247, 0.1429), (0.0, 0.1429, 0.1247, 0.1429), (0.0, 0.2857, 0.1247, 0.1429), (0.1247, 0.0, 0.1259, 0.1429), (0.2506, 0.0, 0.1247, 0.1429), (0.1247, 0.1429, 0.2506, 0.2857), (0.3753, 0.0, 0.1247, 0.1429), (0.3753, 0.1429, 0.1247, 0.1429), (0.3753, 0.2857, 0.1247, 0.1429), (0.5, 0.0, 0.1247, 0.1429), (0.5, 0.1429, 0.1247, 0.1429), (0.5, 0.2857, 0.1247, 0.1429), (0.6247, 0.0, 0.1876, 0.2857), (0.8124, 0.0, 0.1876, 0.2857), (0.6247, 0.2857, 0.1247, 0.1429), (0.7494, 0.2857, 0.1259, 0.1429), (0.8753, 0.2857, 0.1247, 0.1429), (0.0, 0.4286, 0.1247, 0.1429), (0.1247, 0.4286, 0.1259, 0.1429), (0.2506, 0.4286, 0.1247, 0.1429), (0.3753, 0.4286, 0.2494, 0.1429), (0.6247, 0.4286, 0.1259, 0.1429), (0.7506, 0.4286, 0.1247, 0.1429), (0.8753, 0.4286, 0.1247, 0.1429), (0.0, 0.5714, 0.1247, 0.1429), (0.1247, 0.5714, 0.1259, 0.1429), (0.2506, 0.5714, 0.1247, 0.1429), (0.0, 0.7143, 0.1876, 0.2857), (0.1876, 0.7143, 0.1876, 0.2857), (0.3753, 0.5714, 0.1247, 0.1429), (0.3753, 0.7143, 0.1247, 0.1429), (0.3753, 0.8571, 0.1247, 0.1429), (0.5, 0.5714, 0.1247, 0.1429), (0.5, 0.7143, 0.1247, 0.1429), (0.5, 0.8571, 0.1247, 0.1429), (0.6247, 0.5714, 0.2506, 0.2857), (0.6247, 0.8571, 0.1259, 0.1429), (0.7506, 0.8571, 0.1247, 0.1429), (0.8753, 0.5714, 0.1247, 0.1429), (0.8753, 0.7143, 0.1247, 0.1429), (0.8753, 0.8571, 0.1247, 0.1429)],

    "横 layout_family_standard" : [(0.0, 0.0, 0.1247, 0.1429), (0.0, 0.1429, 0.1247, 0.1429), (0.0, 0.2857, 0.1247, 0.1429), (0.1247, 0.0, 0.1259, 0.1429), (0.2506, 0.0, 0.1247, 0.1429), (0.1247, 0.1429, 0.2506, 0.2857), (0.3753, 0.0, 0.1247, 0.1429), (0.3753, 0.1429, 0.1247, 0.1429), (0.3753, 0.2857, 0.1247, 0.1429), (0.5, 0.0, 0.1247, 0.1429), (0.5, 0.1429, 0.1247, 0.1429), (0.5, 0.2857, 0.1247, 0.1429), (0.6247, 0.0, 0.1876, 0.2857), (0.8124, 0.0, 0.1876, 0.2857), (0.6247, 0.2857, 0.1247, 0.1429), (0.7494, 0.2857, 0.1259, 0.1429), (0.8753, 0.2857, 0.1247, 0.1429), (0.0, 0.4286, 0.1247, 0.1429), (0.1247, 0.4286, 0.1259, 0.1429), (0.2506, 0.4286, 0.1247, 0.1429), (0.3753, 0.4286, 0.2494, 0.1429), (0.6247, 0.4286, 0.1259, 0.1429), (0.7506, 0.4286, 0.1247, 0.1429), (0.8753, 0.4286, 0.1247, 0.1429), (0.0, 0.5714, 0.1247, 0.1429), (0.1247, 0.5714, 0.1259, 0.1429), (0.2506, 0.5714, 0.1247, 0.1429), (0.0, 0.7143, 0.1876, 0.2857), (0.1876, 0.7143, 0.1876, 0.2857), (0.3753, 0.5714, 0.1247, 0.1429), (0.3753, 0.7143, 0.1247, 0.1429), (0.3753, 0.8571, 0.1247, 0.1429), (0.5, 0.5714, 0.1247, 0.1429), (0.5, 0.7143, 0.1247, 0.1429), (0.5, 0.8571, 0.1247, 0.1429), (0.6247, 0.5714, 0.2506, 0.2857), (0.6247, 0.8571, 0.1259, 0.1429), (0.7506, 0.8571, 0.1247, 0.1429), (0.8753, 0.5714, 0.1247, 0.1429), (0.8753, 0.7143, 0.1247, 0.1429), (0.8753, 0.8571, 0.1247, 0.1429)],
    "横 layout_size_11" : [(0.0, 0.0, 0.5, 0.4382), (0.0, 0.4382, 0.5, 0.2623), (0.0, 0.7005, 0.2506, 0.2995), (0.2506, 0.7005, 0.2494, 0.2995), (0.5, 0.0, 0.2506, 0.3841), (0.7506, 0.0, 0.2494, 0.1929), (0.7506, 0.1929, 0.2494, 0.1912), (0.5, 0.3841, 0.2506, 0.1929), (0.5, 0.577, 0.2506, 0.1929), (0.7506, 0.3841, 0.2494, 0.3858), (0.5, 0.7699, 0.5, 0.2301)],
    "横 layout_size_18" : [(0.0, 0.0, 0.2221, 0.4454), (0.2221, 0.0, 0.2221, 0.4454), (0.0, 0.4454, 0.2221, 0.2218), (0.2221, 0.4454, 0.2221, 0.2218), (0.0, 0.6672, 0.1485, 0.3328), (0.1485, 0.6672, 0.1473, 0.3328), (0.2957, 0.6672, 0.1485, 0.3328), (0.4442, 0.0, 0.1116, 0.2504), (0.4442, 0.2504, 0.1116, 0.2504), (0.4442, 0.5008, 0.1116, 0.2487), (0.4442, 0.7496, 0.1116, 0.2504), (0.5558, 0.0, 0.1485, 0.3328), (0.7043, 0.0, 0.1473, 0.3328), (0.8515, 0.0, 0.1485, 0.3328), (0.5558, 0.3328, 0.2221, 0.3345), (0.7779, 0.3328, 0.2221, 0.3345), (0.5558, 0.6672, 0.2221, 0.3328), (0.7779, 0.6672, 0.2221, 0.3328)],
    "横 layout_tate_24" : [(0.0, 0.0, 0.1663, 0.1675), (0.0, 0.1675, 0.1663, 0.3333), (0.0, 0.5008, 0.1663, 0.1658), (0.0, 0.6667, 0.1663, 0.3333), (0.1663, 0.0, 0.1663, 0.3181), (0.1663, 0.3181, 0.1663, 0.2267), (0.1663, 0.5448, 0.1663, 0.3181), (0.1663, 0.8629, 0.1663, 0.1371), (0.3325, 0.0, 0.1663, 0.1675), (0.3325, 0.1675, 0.1663, 0.3333), (0.3325, 0.5008, 0.1663, 0.1658), (0.3325, 0.6667, 0.1663, 0.3333), (0.4988, 0.0, 0.1675, 0.3181), (0.4988, 0.3181, 0.1675, 0.2267), (0.4988, 0.5448, 0.1675, 0.3181), (0.4988, 0.8629, 0.1675, 0.1371), (0.6663, 0.0, 0.1663, 0.1675), (0.6663, 0.1675, 0.1663, 0.3333), (0.6663, 0.5008, 0.1663, 0.1658), (0.6663, 0.6667, 0.1663, 0.3333), (0.8325, 0.0, 0.1663, 0.3181), (0.8325, 0.3181, 0.1663, 0.2267), (0.8325, 0.5448, 0.1663, 0.3181), (0.8325, 0.8629, 0.1663, 0.1371)],
    "縦 tiled4x6_default": tile_layout(4, 6),
    "縦 tiled4x6_layout1": [
        tiled46(0, 0),   tiled46(1, 0), tiled46(2, 0, 2),
        tiled46(0, 1),   tiled46(1, 1),
        tiled46(0, 2, 2),             tiled46(2, 2), tiled46(3, 2),
                                      tiled46(2, 3), tiled46(3, 3),
        tiled46(0, 4),   tiled46(1, 4), tiled46(2, 4, 2),
        tiled46(0, 5),   tiled46(1, 5),
    ],
    "size_checker": tile_layout(),
}
SIZE_SWITCH_LAYOUT = ['縦 tiled4x6_default', '縦 tiled4x6_layout1', '縦 grid2x2', '縦 layout3']

STOCK_LAYOUT = tile_layout(1, 20)
